/*!
 * angular-incremental-list
 * @see https://github.com/tfoxy/angular-incremental-list
 * @version 0.4.3 - 2015-10-10T21:20:16.529Z
 * @author Tom√°s Fox <tomas.c.fox@gmail.com>
 * @license MIT
 */
!function(){"use strict";function e(e,i,n){function r(){var t=A.list;if(angular.isUndefined(t)||null===t)throw Error("ilList is "+t+": "+i.ilList);e.$on("$destroy",o)}function o(){A.blurTimeout&&(n.cancel(A.blurTimeout),A.blurTimeout=null)}function u(e,t){if("number"!=typeof e)throw new Error("scope.$index is not a number. Got: "+e);var i=A.list.length,n=l(e);S.currentScope=n,S.changed=t,e===i-1&&i<A.maxLength?f():e===i-2&&i>A.minLength?d():i>A.minLength&&A.checkDecreaseConditions(),delete S.currentScope,delete S.changed,A.notifyParentList(n,t)}function c(){function e(){m(S.currentScope,S.currentScope.$index)}A.checkDecreaseConditions=e}function l(e){return e>=A.list.length||0>e?null:A.list[e][h]}function s(e){return l(e.$index-1)}function a(e){return l(e.$index+1)}function f(){A.mustIncrement()?A.list.push(A.createItem()):S.currentScope.$first||d()}function d(){var e=S.currentScope,t=e.$last?s(e):a(e);A.mustDecrement()&&p(t)&&(e.$last||A.list.pop(),m(s(e)))}function p(e){return S.currentScope=e,A.mustDecrement()}function m(e,t){var i,n,r=A.minLength-1,o=e;for(i=n=t>=0?t:A.list.length-2;i>=r&&p(o);--i,o=s(o));A.list.splice(i+1,n-i)}function v(e){return S.currentScope.$eval(e,M)}function L(){return{}}function $(){return A.focusIndex===S.currentScope.$index}function g(){var i=A.list.length,n=l(i-1)||e;if(i<A.minLength){var r=new t(A.minLength-i,A,I);A.scopeCreatedAt=r.scopeCreatedAt.bind(r),r.pushItem(n)}else i>A.maxLength&&A.list.splice(A.maxLength,i-A.maxLength)}function I(e,t){var i=A.list[e];Object.defineProperty(i,h,{configurable:!0,enumerable:!1,value:t}),t.$$ilListModels=[],t.$$ilListChildCtrls=[],t.$on("$destroy",function(){delete i[h]})}function x(e,t){function i(t){var r=t||S.currentScope,o=r.$$ilListModels.every(function(t){return e^!C(t[n])});return o?r.$$ilListChildCtrls.every(function(e){return e.list.every(function(e){return i(e[h])})}):!1}var n=t?"$modelValue":"$viewValue";return i}function y(){var e=S.changed.$modelValue;return C(e)}function C(e){return e||0===e}function b(){var e=S.changed.$viewValue;return C(e)}var A=this,S={emptyModel:x(!1,!0),emptyView:x(!1,!1),fullModel:x(!0,!0),fullView:x(!0,!1),hasFocus:$,modelExists:y,viewExists:b},M={$ilList:S};A.blurTimeout=null,A.cancelBlurTimeout=o,A.checkDecreaseConditions=angular.noop,A.createItem=L,A.enableMiddleDecrease=c,A.evalWithCurrentScope=v,A.focusIndex=-1,A.list=e.$eval(i.ilList),A.listenToEvents=angular.noop,A.listItemChanged=u,A.localScope=M,A.maxLength=9007199254740991,A.minLength=1,A.mustDecrement=S.emptyView,A.mustIncrement=y,A.notifyParentList=angular.noop,A.postInitialize=g,A.scopeCreatedAt=I,r()}function t(e,t,i){this._countdown=e,this._vm=t,this._scopeCreatedAt=i}function i(){return{restrict:"A",priority:L,controller:e,link:function(e,t,i,n){n.postInitialize()}}}function n(){return{restrict:"A",require:"ilList",link:{pre:function(e,t,i,n){var r=e.$index;if("number"!=typeof r)throw new Error("scope.$index is not a number. Got: "+r);n.scopeCreatedAt(r,e)}}}}function r(){return{restrict:"A",require:["^ilList","ngModel"],link:function(e,t,i,n){var r=n[0],o=n[1],u=i.ilItemModel?e.$eval(i.ilItemModel):e,c=function(){r.listItemChanged(u.$index,o)};o.$viewChangeListeners.push(c),m(u.$$ilListModels,o,e),r.listenToEvents(u,t,c)}}}function o(){return{restrict:"A",require:"ilList",priority:v,link:function(e,t,i,n){n.createItem=function(){return n.evalWithCurrentScope(i.ilNewItem)}}}}function u(){return{restrict:"A",require:"ilList",priority:v,link:function(e,t,i,n){n.mustIncrement=function(){return n.evalWithCurrentScope(i.ilIncreaseOn)}}}}function c(){return{restrict:"A",require:"ilList",priority:v,link:function(e,t,i,n){n.mustDecrement=function(){return n.evalWithCurrentScope(i.ilDecreaseOn)}}}}function l(){return{restrict:"A",require:["^^ilList","ilList"],priority:v,link:function(e,t,i,n){var r=n[0],o=n[1];o.notifyParentList=function(e,t){var n=i.ilListModel?e.$eval(i.ilListModel):e.$parent;r.listItemChanged(n.$index,t)},m(e.$$ilListChildCtrls,o,e)}}}function s(){return{restrict:"A",require:"ilList",priority:v,link:function(e,t,i,n){var r=parseInt(i.ilMinLength);n.minLength=r>0?r:0}}}function a(){return{restrict:"A",require:"ilList",priority:v,link:function(e,t,i,n){var r=parseInt(i.ilMaxLength);n.maxLength=r>0?r:0}}}function f(e){function t(t,i,n,r){r.listenToEvents=function(t,i,n){i.on("focus",function(){r.cancelBlurTimeout(),r.focusIndex=t.$index,r.blurListener&&(t.$apply(r.blurListener),r.blurListener=null,r.focusIndex=t.$index),t.$apply(n),r.focusIndex=t.$index}),i.on("blur",function(){r.blurListener=n,r.blurTimeout=e(function(){r.blurTimeout=null,r.focusIndex=-1,r.blurListener=null,n()})})}}return{restrict:"A",require:"ilList",priority:v,link:t}}function d(){return{restrict:"A",require:"ilList",priority:v,link:function(e,t,i,n){n.enableMiddleDecrease()}}}function p(e,t){var i=e.indexOf(t);i>=0&&e.splice(i,1)}function m(e,t,i){e.push(t),i.$on("$destroy",function(){p(e,i)})}var h="$$ilListScope";e.$inject=["$scope","$attrs","$timeout"],t.prototype.pushItem=function(e){this._vm.localScope.$ilList.currentScope=e,this._vm.list.push(this._vm.createItem()),--this._countdown<=0&&(this._vm.scopeCreatedAt=this._scopeCreatedAt),delete this._vm.localScope.$ilList.currentScope},t.prototype.scopeCreatedAt=function(e,t){this._scopeCreatedAt(e,t),this.pushItem(t)};var v=2e3,L=3e3;f.$inject=["$timeout"],angular.module("incrementalList",[]).directive("ilList",i).directive("ilList",n).directive("ilItemModel",r).directive("ilNewItem",o).directive("ilIncreaseOn",u).directive("ilDecreaseOn",c).directive("ilListModel",l).directive("ilMinLength",s).directive("ilMaxLength",a).directive("ilEnableHasFocus",f).directive("ilDecreaseMiddle",d)}();